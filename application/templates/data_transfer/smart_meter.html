<head>
	<title>Smart Meter</title>
</head>

{% extends "base.html" %}

{% block body %}

<!--Page content-->
<div class="container mt-5">    
	<h1>Smart Meter</h1>

	<!--<div class="input-group date" id="datetimepicker1" data-target-input="nearest">
		<input type="text" class="form-control datetimepicker-input" data-target="#datetimepicker1"/>
		<div class="input-group-append" data-target="#datetimepicker1" data-toggle="datetimepicker">
			<div class="input-group-text"><i class="fa fa-calendar"></i></div>
		</div>
	</div>-->
		<div class="mb-3">
			<label class="form-label">Specify the meters, date & time range to download files from the <b>Smart Meter Windows machine</b> <i style="color:red;">(IP: <b>{{ip}}</b>)</i></label><br />
			<form action="/data_transfer/smart_meter" method="POST">
				<div>{{ form.data_source.label }}: {{ form.data_source }}</div>
				<div>{{ form.meters.label }}: {{ form.meters }}</div>
				<div>{{ form.file_type.label }}: {% for type in form.file_type %}
					<tr>
						<td>{{type}}</td>
						<td>{{type.label}}</td>
					</tr>
				{% endfor %}</div>
				<div>{{ form.date.label }}: {{ form.date }}</div>
				<div>{{ form.start_time.label }}: {{ form.start_time }}</div>
				<div>{{ form.end_time.label }}: {{ form.end_time }}</div>
				<!--<div>{{ form.export_name.label }}: {{ form.export_name }}</div>-->
				<div>{{ form.submit(class="btn btn-primary")}}</div>
			</form>
		</div>

		<br /><br /><hr /><br /><br />

		<div class="mb-3">
			<label class="form-label">Initiate Secure FTP connection to the <b>Smart Meter Windows machine</b> <i style="color:red;">(IP: <b>{{ip}}</b>)</i></label><br />
			<form action="/data_transfer/smart_meter" method="POST">
				<input type="hidden" name="smart_meter_form" value="SmartMeterData">
				<button class="btn btn-primary" type="submit">
				{% if not file_dict or data_source != "SmartMeterData" %}
					To /SmartMeterData
				{% else %}Re-initiate FTP{% endif %}
				</button>
			</form>
			<form action="/data_transfer/smart_meter" method="POST">
				<input type="hidden" name="smart_meter_form" value="Archive_SmartMeterData">
				<button class="btn btn-warning" type="submit">
				{% if not file_dict or data_source != "Archive_SmartMeterData" %}
					To /Archive_SmartMeterData
				{% else %}Re-initiate FTP{% endif %}
				</button>
			</form>
			<form action="/data_transfer/smart_meter" method="POST">
				<input type="hidden" name="smart_meter_form" value="WiresharkData">
				<button class="btn btn-info" type="submit">
				{% if not file_dict or data_source != "WiresharkData" %}
					To /WiresharkData
				{% else %}Re-initiate FTP{% endif %}
				</button>
			</form>
		</div>

	{% if file_dict %}
	<label class="form-label">Select one or more files from the <b>{{ data_source }} directory</b> of the <b>Smart Meter Windows machine</b>.</label><br />
	<form action="/data_transfer/smart_meter" method="POST">
		{% for dir in file_dict %}
			{% for file in file_dict[dir] %}
				<div class="form-check">
					<input type="hidden" name="data_source" value="{{ data_source }}">
					<input class="form-check-input" type="checkbox" name="smart_meter_form" value="{{ dir ~':'~ file }}" id="{{dir ~'-'~ file}}">
					<label class="form-check-label" for="{{dir ~'-'~ file}}">
						{{ dir ~": "~ file }}
					</label>
				</div>
			{% endfor %}
		{% endfor %}
		<button class="btn btn-primary" type="submit">Transfer File(s)</button>
	</form>
	{% endif %}
</div>

{% endblock %}
